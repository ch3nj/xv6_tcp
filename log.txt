riscv64-unknown-elf-gcc -Wall -Werror -O -fno-omit-frame-pointer -ggdb -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -DNET_TESTS_PORT=25600 -fno-pie -no-pie   -c -o kernel/sysnet.o kernel/sysnet.c
riscv64-unknown-elf-ld -z max-page-size=4096 -T kernel/kernel.ld -o kernel/kernel kernel/entry.o kernel/start.o kernel/console.o kernel/printf.o kernel/uart.o kernel/kalloc.o kernel/spinlock.o kernel/string.o kernel/main.o kernel/vm.o kernel/proc.o kernel/swtch.o kernel/trampoline.o kernel/trap.o kernel/syscall.o kernel/sysproc.o kernel/bio.o kernel/fs.o kernel/log.o kernel/sleeplock.o kernel/file.o kernel/pipe.o kernel/exec.o kernel/sysfile.o kernel/kernelvec.o kernel/plic.o kernel/virtio_disk.o kernel/e1000.o kernel/net.o kernel/sysnet.o kernel/pci.o kernel/buddy.o kernel/list.o
riscv64-unknown-elf-objdump -S kernel/kernel > kernel/kernel.asm
riscv64-unknown-elf-objdump -t kernel/kernel | sed '1,/SYMBOL TABLE/d; s/ .* / /; /^$/d' > kernel/kernel.sym
qemu-system-riscv64 -machine virt -bios none -kernel kernel/kernel -m 128M -smp 1 -nographic -drive file=fs.img,if=none,format=raw,id=x0 -device virtio-blk-device,drive=x0,bus=virtio-mmio-bus.0 -netdev user,id=net0,hostfwd=udp::26500-:2000 -object filter-dump,id=net0,netdev=net0,file=packets.pcap -device e1000,netdev=net0,bus=pcie.0

xv6 kernel is booting

virtio disk init 0
process 0x0000000000000001 about to sleep on channel 0x0000000080017b00 with lock 0x00000000800260b0
process 0x0000000000000001 being woken up on channel 0x0000000080017b00
process 0x0000000000000001 about to sleep on channel 0x0000000080017f60 with lock 0x00000000800260b0
process 0x0000000000000001 being woken up on channel 0x0000000080017f60
process 0x0000000000000001 about to sleep on channel 0x0000000080017f60 with lock 0x00000000800260b0
process 0x0000000000000001 being woken up on channel 0x0000000080017f60
process 0x0000000000000001 about to sleep on channel 0x00000000800183c0 with lock 0x00000000800260b0
process 0x0000000000000001 being woken up on channel 0x00000000800183c0
process 0x0000000000000001 about to sleep on channel 0x0000000080018820 with lock 0x00000000800260b0
process 0x0000000000000001 being woken up on channel 0x0000000080018820
process 0x0000000000000001 about to sleep on channel 0x0000000080018c80 with lock 0x00000000800260b0
process 0x0000000000000001 being woken up on channel 0x0000000080018c80
process 0x0000000000000001 about to sleep on channel 0x00000000800190e0 with lock 0x00000000800260b0
process 0x0000000000000001 being woken up on channel 0x00000000800190e0
process 0x0000000000000001 about to sleep on channel 0x0000000080019540 with lock 0x00000000800260b0
process 0x0000000000000001 being woken up on channel 0x0000000080019540
process 0x0000000000000001 about to sleep on channel 0x00000000800199a0 with lock 0x00000000800260b0
process 0x0000000000000001 being woken up on channel 0x00000000800199a0
init: starting sh
process 0x0000000000000001 about to sleep on channel 0x0000000080016c60 with lock 0x0000000080016c60
process 0x0000000000000002 about to sleep on channel 0x0000000080019e00 with lock 0x00000000800260b0
process 0x0000000000000002 being woken up on channel 0x0000000080019e00
process 0x0000000000000002 about to sleep on channel 0x000000008001a260 with lock 0x00000000800260b0
process 0x0000000000000002 being woken up on channel 0x000000008001a260
process 0x0000000000000002 about to sleep on channel 0x000000008001a6c0 with lock 0x00000000800260b0
process 0x0000000000000002 being woken up on channel 0x000000008001a6c0
process 0x0000000000000002 about to sleep on channel 0x000000008001ab20 with lock 0x00000000800260b0
process 0x0000000000000002 being woken up on channel 0x000000008001ab20
process 0x0000000000000002 about to sleep on channel 0x000000008001af80 with lock 0x00000000800260b0
process 0x0000000000000002 being woken up on channel 0x000000008001af80
process 0x0000000000000002 about to sleep on channel 0x000000008001b3e0 with lock 0x00000000800260b0
process 0x0000000000000002 being woken up on channel 0x000000008001b3e0
$ process 0x0000000000000002 about to sleep on channel 0x00000000800148a0 with lock 0x0000000080014800
nettests
process 0x0000000000000002 being woken up on channel 0x00000000800148a0
process 0x0000000000000002 about to sleep on channel 0x0000000080016dd0 with lock 0x0000000080016dd0
process 0x0000000000000003 about to sleep on channel 0x000000008001b840 with lock 0x00000000800260b0
process 0x0000000000000003 being woken up on channel 0x000000008001b840
process 0x0000000000000003 about to sleep on channel 0x000000008001bca0 with lock 0x00000000800260b0
process 0x0000000000000003 being woken up on channel 0x000000008001bca0
process 0x0000000000000003 about to sleep on channel 0x000000008001c100 with lock 0x00000000800260b0
process 0x0000000000000003 being woken up on channel 0x000000008001c100
testing one ping: hi1
hi2
calling sockwrite
t udp
t ip
T1
T2
finished transmitting
generating interrupt!
REC1
REC2
ARP
r arp
t arp
T1
T2
finished transmitting
REC2
IP
r udp
calling sockrecvudp
sockrecvudp
0x0000000087eed000: waking up
generating interrupt!
REC1
calling sockwrite
t udp
t ip
T1
T2
finished transmitting
generating interrupt!
REC1
REC2
IP
r udp
calling sockrecvudp
sockrecvudp
0x0000000087eed000: waking up
hi3
sockread
0x0000000087eed000: acquired si lock
0x0000000087eed000: finish sockread for 
hi4
hi5
OK
testing single-process pings: hi1
hi2
calling sockwrite
t udp
t ip
T1
T2
finished transmitting
generating interrupt!
REC1
REC2
IP
r udp
calling sockrecvudp
sockrecvudp
0x0000000087eed000: waking up
hi3
sockread
0x0000000087eed000: acquired si lock
0x0000000087eed000: finish sockread for 
hi4
hi5
hi1
hi2
calling sockwrite
t udp
t ip
T1
T2
finished transmitting
hgenerating interrupt!
REC1
REC2
IP
r udp
calling sockrecvudp
sockrecvudp
0x0000000087eed000: waking up
i3
sockread
0x0000000087eed000: acquired si lock
0x0000000087eed000: finish sockread for 
hi4
hi5
hi1
hi2
calling sockwrite
t udp
t ip
T1
T2
finished transmitting
generating interrupt!
REC1
REC2
IP
r udp
calling sockrecvudp
sockrecvudp
0x0000000087eed000: waking up
hi3
sockread
0x0000000087eed000: acquired si lock
0x0000000087eed000: finish sockread for 
hi4
hi5
hi1
hi2
calling sockwrite
t udp
t ip
T1
T2
finished transmitting
generating interrupt!
REC1
REC2
IP
r udp
calling sockrecvudp
sockrecvudp
0x0000000087eed000: waking up
hi3
sockread
0x0000000087eed000: acquired si lock
0x0000000087eed000: finish sockread for 
hi4
hi5
hi1
hi2
calling sockwrite
t udp
t ip
T1
T2
finished transmitting
generating interrupt!
REC1
REC2
IP
r udp
calling sockrecvudp
sockrecvudp
0x0000000087eed000: waking up
hi3
sockread
0x0000000087eed000: acquired si lock
0x0000000087eed000: finish sockread for 
hi4
hi5
hi1
hi2
calling sockwrite
t udp
t ip
T1
T2
finished transmitting
generating interrupt!
REC1
REC2
IP
r udp
calling sockrecvudp
sockrecvudp
0x0000000087eed000: waking up
hi3
sockread
0x0000000087eed000: acquired si lock
0x0000000087eed000: finish sockread for 
hi4
hi5
hi1
hi2
calling sockwrite
t udp
t ip
T1
T2
finished transmitting
generating interrupt!
REC1
REC2
IP
r udp
calling sockrecvudp
sockrecvudp
0x0000000087eed000: waking up
hi3
sockread
0x0000000087eed000: acquired si lock
0x0000000087eed000: finish sockread for 
hi4
hi5
hi1
hi2
calling sockwrite
t udp
t ip
T1
T2
finished transmitting
generating interrupt!
REC1
REC2
IP
r udp
calling sockrecvudp
sockrecvudp
0x0000000087eed000: waking up
hi3
sockread
0x0000000087eed000: acquired si lock
0x0000000087eed000: finish sockread for 
hi4
hi5
hi1
hi2
calling sockwrite
t udp
t ip
T1
T2
finished transmitting
generating interrupt!
REC1
REC2
IP
r udp
calling sockrecvudp
sockrecvudp
0x0000000087eed000: waking up
hi3
sockread
0x0000000087eed000: acquired si lock
0x0000000087eed000: finish sockread for 
hi4
hi5
hi1
hi2
calling sockwrite
t udp
t ip
T1
T2
finished transmitting
generating interrupt!
REC1
REC2
IP
r udp
calling sockrecvudp
sockrecvudp
0x0000000087eed000: waking up
hi3
sockread
0x0000000087eed000: acquired si lock
0x0000000087eed000: finish sockread for 
hi4
hi5
OK
testing multi-process pings: process 0x0000000000000003 about to sleep on channel 0x0000000080016f40 with lock 0x0000000080016f40
hi1
hi2
calling sockwrite
t udp
t ip
T1
T2
finished transmitting
hi3
sockread
0x0000000087eb2000: acquired si lock
0x0000000087eb2000: sleeping
process 0x0000000000000004 about to sleep on channel 0x0000000087eb2030 with lock 0x0000000087eb2010
hi1
hi2
calling sockwrite
t udp
t ip
T1
T2
finished transmitting
hi3
sockread
0x0000000087eb0000: acquired si lock
0x0000000087eb0000: sleeping
process 0x0000000000000005 about to sleep on channel 0x0000000087eb0030 with lock 0x0000000087eb0010
hi1
hi2
calling sockwrite
t udp
t ip
T1
T2
finished transmitting
hi3
sockread
0x0000000087eae000: acquired si lock
0x0000000087eae000: sleeping
process 0x0000000000000006 about to sleep on channel 0x0000000087eae030 with lock 0x0000000087eae010
hi1
hi2
calling sockwrite
t udp
t ip
T1
T2
finished transmitting
hi3
sockread
0x0000000087eac000: acquired si lock
0x0000000087eac000: sleeping
process 0x0000000000000007 about to sleep on channel 0x0000000087eac030 with lock 0x0000000087eac010
hi1
hi2
calling sockwrite
t udp
t ip
T1
T2
finished transmitting
hi3
sockread
0x0000000087f19000: acquired si lock
0x0000000087f19000: sleeping
process 0x0000000000000008 about to sleep on channel 0x0000000087f19030 with lock 0x0000000087f19010
hi1
hi2
calling sockwrite
t udp
t ip
T1
T2
finished transmitting
hi3
sockread
0x0000000087f18000: acquired si lock
0x0000000087f18000: sleeping
process 0x0000000000000009 about to sleep on channel 0x0000000087f18030 with lock 0x0000000087f18010
hi1
hi2
calling sockwrite
t udp
t ip
T1
T2
finished transmitting
hi3
sockread
0x0000000087f16000: acquired si lock
0x0000000087f16000: sleeping
process 0x000000000000000a about to sleep on channel 0x0000000087f16030 with lock 0x0000000087f16010
generating interrupt!
REC1
REC2
IP
r udp
calling sockrecvudp
sockrecvudp
0x0000000087f16000: waking up
process 0x000000000000000a being woken up on channel 0x0000000087f16030
REC2
IP
r udp
calling sockrecvudp
sockrecvudp
0x0000000087f18000: waking up
process 0x0000000000000009 being woken up on channel 0x0000000087f18030
REC2
IP
r udp
calling sockrecvudp
sockrecvudp
0x0000000087f19000: waking up
process 0x0000000000000008 being woken up on channel 0x0000000087f19030
REC2
IP
r udp
calling sockrecvudp
sockrecvudp
0x0000000087eac000: waking up
process 0x0000000000000007 being woken up on channel 0x0000000087eac030
REC2
IP
r udp
calling sockrecvudp
sockrecvudp
0x0000000087eae000: waking up
process 0x0000000000000006 being woken up on channel 0x0000000087eae030
REC2
IP
r udp
calling sockrecvudp
sockrecvudp
0x0000000087eb0000: waking up
process 0x0000000000000005 being woken up on channel 0x0000000087eb0030
REC2
IP
r udp
calling sockrecvudp
sockrecvudp
0x0000000087eb2000: waking up
process 0x0000000000000004 being woken up on channel 0x0000000087eb2030
0x0000000087eb2000: woken up
0x0000000087eb2000: finish sockread for 
hi4
QEMU: Terminated
